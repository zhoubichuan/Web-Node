<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>堆栈内存及垃圾回收机制 | JavaScript笔记</title>
    <meta name="description" content="个人总结的vuepress学习技术文档-语法">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
  <link rel="icon" href="/Web-Node/favicon.ico">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="msapplication-TileColor" content="#000000">
    <meta name="keywords" content="vuepress,最新技术文档,vuepress语法,markdown语法">
    <link rel="preload" href="/Web-Node/assets/css/0.styles.dca708c7.css" as="style"><link rel="preload" href="/Web-Node/assets/js/app.3f8e6221.js" as="script"><link rel="preload" href="/Web-Node/assets/js/41.8b6b5854.js" as="script"><link rel="prefetch" href="/Web-Node/assets/js/10.bcbdedf2.js"><link rel="prefetch" href="/Web-Node/assets/js/100.f6b12536.js"><link rel="prefetch" href="/Web-Node/assets/js/101.93c6c50d.js"><link rel="prefetch" href="/Web-Node/assets/js/102.553488df.js"><link rel="prefetch" href="/Web-Node/assets/js/103.75e90cde.js"><link rel="prefetch" href="/Web-Node/assets/js/104.82fda765.js"><link rel="prefetch" href="/Web-Node/assets/js/105.ba2c3e75.js"><link rel="prefetch" href="/Web-Node/assets/js/106.626facfa.js"><link rel="prefetch" href="/Web-Node/assets/js/107.ebef0a88.js"><link rel="prefetch" href="/Web-Node/assets/js/108.f686e1a7.js"><link rel="prefetch" href="/Web-Node/assets/js/109.ee32c66f.js"><link rel="prefetch" href="/Web-Node/assets/js/11.e347bbcb.js"><link rel="prefetch" href="/Web-Node/assets/js/110.fc2b8c84.js"><link rel="prefetch" href="/Web-Node/assets/js/111.6e912d00.js"><link rel="prefetch" href="/Web-Node/assets/js/112.42119ca0.js"><link rel="prefetch" href="/Web-Node/assets/js/113.c2f233c7.js"><link rel="prefetch" href="/Web-Node/assets/js/114.e7a86ce9.js"><link rel="prefetch" href="/Web-Node/assets/js/115.1972b873.js"><link rel="prefetch" href="/Web-Node/assets/js/116.d9daf171.js"><link rel="prefetch" href="/Web-Node/assets/js/117.3f5606aa.js"><link rel="prefetch" href="/Web-Node/assets/js/118.1e9b095b.js"><link rel="prefetch" href="/Web-Node/assets/js/119.8d006863.js"><link rel="prefetch" href="/Web-Node/assets/js/12.3fc6bdeb.js"><link rel="prefetch" href="/Web-Node/assets/js/120.44e54f56.js"><link rel="prefetch" href="/Web-Node/assets/js/121.5a3a01b1.js"><link rel="prefetch" href="/Web-Node/assets/js/122.196e304e.js"><link rel="prefetch" href="/Web-Node/assets/js/123.2e8031f8.js"><link rel="prefetch" href="/Web-Node/assets/js/124.05914df9.js"><link rel="prefetch" href="/Web-Node/assets/js/125.655a5454.js"><link rel="prefetch" href="/Web-Node/assets/js/126.f452e22d.js"><link rel="prefetch" href="/Web-Node/assets/js/127.51a928e6.js"><link rel="prefetch" href="/Web-Node/assets/js/128.0c4ab3f4.js"><link rel="prefetch" href="/Web-Node/assets/js/129.e757d553.js"><link rel="prefetch" href="/Web-Node/assets/js/13.945779d7.js"><link rel="prefetch" href="/Web-Node/assets/js/130.b4428332.js"><link rel="prefetch" href="/Web-Node/assets/js/131.781c5920.js"><link rel="prefetch" href="/Web-Node/assets/js/132.b3a6f9e0.js"><link rel="prefetch" href="/Web-Node/assets/js/133.438ac740.js"><link rel="prefetch" href="/Web-Node/assets/js/134.e679d205.js"><link rel="prefetch" href="/Web-Node/assets/js/135.02d11976.js"><link rel="prefetch" href="/Web-Node/assets/js/136.d1ddb140.js"><link rel="prefetch" href="/Web-Node/assets/js/137.af69275d.js"><link rel="prefetch" href="/Web-Node/assets/js/138.d41cf352.js"><link rel="prefetch" href="/Web-Node/assets/js/139.41a99bcf.js"><link rel="prefetch" href="/Web-Node/assets/js/14.789f64d9.js"><link rel="prefetch" href="/Web-Node/assets/js/140.73d5ecd3.js"><link rel="prefetch" href="/Web-Node/assets/js/141.5e5dbd43.js"><link rel="prefetch" href="/Web-Node/assets/js/142.a92682c9.js"><link rel="prefetch" href="/Web-Node/assets/js/143.9d4760b9.js"><link rel="prefetch" href="/Web-Node/assets/js/144.5ff2dcc8.js"><link rel="prefetch" href="/Web-Node/assets/js/145.3b4b4197.js"><link rel="prefetch" href="/Web-Node/assets/js/146.43f00c7c.js"><link rel="prefetch" href="/Web-Node/assets/js/147.ffd2feb8.js"><link rel="prefetch" href="/Web-Node/assets/js/148.44d5f4c7.js"><link rel="prefetch" href="/Web-Node/assets/js/149.dc8d51a7.js"><link rel="prefetch" href="/Web-Node/assets/js/15.269cc528.js"><link rel="prefetch" href="/Web-Node/assets/js/150.d983d318.js"><link rel="prefetch" href="/Web-Node/assets/js/151.9731aa70.js"><link rel="prefetch" href="/Web-Node/assets/js/152.b872494f.js"><link rel="prefetch" href="/Web-Node/assets/js/153.e84eb35b.js"><link rel="prefetch" href="/Web-Node/assets/js/154.9e11aecc.js"><link rel="prefetch" href="/Web-Node/assets/js/155.1c81b6db.js"><link rel="prefetch" href="/Web-Node/assets/js/16.1c494600.js"><link rel="prefetch" href="/Web-Node/assets/js/17.7323a6f1.js"><link rel="prefetch" href="/Web-Node/assets/js/18.d7474c22.js"><link rel="prefetch" href="/Web-Node/assets/js/19.ffedbce8.js"><link rel="prefetch" href="/Web-Node/assets/js/2.f3095994.js"><link rel="prefetch" href="/Web-Node/assets/js/20.36f9dc66.js"><link rel="prefetch" href="/Web-Node/assets/js/21.d3cbf4e3.js"><link rel="prefetch" href="/Web-Node/assets/js/22.7429e70e.js"><link rel="prefetch" href="/Web-Node/assets/js/23.4dd6db5c.js"><link rel="prefetch" href="/Web-Node/assets/js/24.c4b66709.js"><link rel="prefetch" href="/Web-Node/assets/js/25.d0384634.js"><link rel="prefetch" href="/Web-Node/assets/js/26.4688db93.js"><link rel="prefetch" href="/Web-Node/assets/js/27.c83928bc.js"><link rel="prefetch" href="/Web-Node/assets/js/28.ec1eb6e7.js"><link rel="prefetch" href="/Web-Node/assets/js/29.e47f6b5d.js"><link rel="prefetch" href="/Web-Node/assets/js/3.7ba0e909.js"><link rel="prefetch" href="/Web-Node/assets/js/30.bb4152e9.js"><link rel="prefetch" href="/Web-Node/assets/js/31.e41bbae6.js"><link rel="prefetch" href="/Web-Node/assets/js/32.7724aeb6.js"><link rel="prefetch" href="/Web-Node/assets/js/33.80359b3b.js"><link rel="prefetch" href="/Web-Node/assets/js/34.197a3382.js"><link rel="prefetch" href="/Web-Node/assets/js/35.03d1c772.js"><link rel="prefetch" href="/Web-Node/assets/js/36.9c0e346f.js"><link rel="prefetch" href="/Web-Node/assets/js/37.58a13553.js"><link rel="prefetch" href="/Web-Node/assets/js/38.d3762e2e.js"><link rel="prefetch" href="/Web-Node/assets/js/39.ad7401e0.js"><link rel="prefetch" href="/Web-Node/assets/js/4.f57ad261.js"><link rel="prefetch" href="/Web-Node/assets/js/40.c7d0ea21.js"><link rel="prefetch" href="/Web-Node/assets/js/42.a3e58719.js"><link rel="prefetch" href="/Web-Node/assets/js/43.a4017144.js"><link rel="prefetch" href="/Web-Node/assets/js/44.414f4633.js"><link rel="prefetch" href="/Web-Node/assets/js/45.00586e9c.js"><link rel="prefetch" href="/Web-Node/assets/js/46.481640fe.js"><link rel="prefetch" href="/Web-Node/assets/js/47.4455414e.js"><link rel="prefetch" href="/Web-Node/assets/js/48.4d25539f.js"><link rel="prefetch" href="/Web-Node/assets/js/49.b4809994.js"><link rel="prefetch" href="/Web-Node/assets/js/5.277dafe4.js"><link rel="prefetch" href="/Web-Node/assets/js/50.8369f71c.js"><link rel="prefetch" href="/Web-Node/assets/js/51.6ffa102f.js"><link rel="prefetch" href="/Web-Node/assets/js/52.0ad399c4.js"><link rel="prefetch" href="/Web-Node/assets/js/53.c0e2a8b0.js"><link rel="prefetch" href="/Web-Node/assets/js/54.e51423c6.js"><link rel="prefetch" href="/Web-Node/assets/js/55.3eee815a.js"><link rel="prefetch" href="/Web-Node/assets/js/56.ad221357.js"><link rel="prefetch" href="/Web-Node/assets/js/57.edfc5cee.js"><link rel="prefetch" href="/Web-Node/assets/js/58.996cbef4.js"><link rel="prefetch" href="/Web-Node/assets/js/59.437c9d28.js"><link rel="prefetch" href="/Web-Node/assets/js/6.5c54a787.js"><link rel="prefetch" href="/Web-Node/assets/js/60.ba7a010e.js"><link rel="prefetch" href="/Web-Node/assets/js/61.07c0e915.js"><link rel="prefetch" href="/Web-Node/assets/js/62.468c0219.js"><link rel="prefetch" href="/Web-Node/assets/js/63.ddd50a89.js"><link rel="prefetch" href="/Web-Node/assets/js/64.9c1b5a81.js"><link rel="prefetch" href="/Web-Node/assets/js/65.8be0d160.js"><link rel="prefetch" href="/Web-Node/assets/js/66.26a7e307.js"><link rel="prefetch" href="/Web-Node/assets/js/67.83f49a3f.js"><link rel="prefetch" href="/Web-Node/assets/js/68.ce69e648.js"><link rel="prefetch" href="/Web-Node/assets/js/69.cc747c02.js"><link rel="prefetch" href="/Web-Node/assets/js/7.66b4ea27.js"><link rel="prefetch" href="/Web-Node/assets/js/70.237cf84b.js"><link rel="prefetch" href="/Web-Node/assets/js/71.a05514f5.js"><link rel="prefetch" href="/Web-Node/assets/js/72.c8058260.js"><link rel="prefetch" href="/Web-Node/assets/js/73.b981fd34.js"><link rel="prefetch" href="/Web-Node/assets/js/74.5f5c91ae.js"><link rel="prefetch" href="/Web-Node/assets/js/75.ed4cf607.js"><link rel="prefetch" href="/Web-Node/assets/js/76.d2c908bd.js"><link rel="prefetch" href="/Web-Node/assets/js/77.316cc7c1.js"><link rel="prefetch" href="/Web-Node/assets/js/78.51366828.js"><link rel="prefetch" href="/Web-Node/assets/js/79.4a7f7b41.js"><link rel="prefetch" href="/Web-Node/assets/js/8.d9738dc8.js"><link rel="prefetch" href="/Web-Node/assets/js/80.1df726ad.js"><link rel="prefetch" href="/Web-Node/assets/js/81.4f0355cf.js"><link rel="prefetch" href="/Web-Node/assets/js/82.83bd45fb.js"><link rel="prefetch" href="/Web-Node/assets/js/83.2643997d.js"><link rel="prefetch" href="/Web-Node/assets/js/84.6b887fe4.js"><link rel="prefetch" href="/Web-Node/assets/js/85.2d7365f6.js"><link rel="prefetch" href="/Web-Node/assets/js/86.d364d1c3.js"><link rel="prefetch" href="/Web-Node/assets/js/87.a2586737.js"><link rel="prefetch" href="/Web-Node/assets/js/88.a090aa35.js"><link rel="prefetch" href="/Web-Node/assets/js/89.6ed702fe.js"><link rel="prefetch" href="/Web-Node/assets/js/9.9fc74723.js"><link rel="prefetch" href="/Web-Node/assets/js/90.e07752c6.js"><link rel="prefetch" href="/Web-Node/assets/js/91.10815d7b.js"><link rel="prefetch" href="/Web-Node/assets/js/92.6c0ae2e7.js"><link rel="prefetch" href="/Web-Node/assets/js/93.d155541f.js"><link rel="prefetch" href="/Web-Node/assets/js/94.016dd221.js"><link rel="prefetch" href="/Web-Node/assets/js/95.5c2f637b.js"><link rel="prefetch" href="/Web-Node/assets/js/96.3c83ed06.js"><link rel="prefetch" href="/Web-Node/assets/js/97.02c5ebb5.js"><link rel="prefetch" href="/Web-Node/assets/js/98.6ca46a1c.js"><link rel="prefetch" href="/Web-Node/assets/js/99.09f3ff10.js">
    <link rel="stylesheet" href="/Web-Node/assets/css/0.styles.dca708c7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Web-Node/" class="home-link router-link-active"><!----> <span class="site-name">JavaScript笔记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web-Node/base/stack/1.dataType.html" class="nav-link">一、堆栈内存和闭包作用域</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/oop/1.objectOriented.html" class="nav-link">二、面向对象程序设计</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/3.browser/1.browser.html" class="nav-link">三、浏览器渲染机制</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/dom/1.event.html" class="nav-link">四、DOM事件及设计模式</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/es6/1.let.html" class="nav-link">五、ES6+核心源码分析</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/http/1.http.html" class="nav-link">六、AJAX/HTTP数据通信</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">专项知识</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web-Node/senior/performance/1.CDN.html" class="nav-link">一、前端性能优化</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/typeScript/15.api.html" class="nav-link">二、TypeScript</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/monitor/13.jiankong.html" class="nav-link">三、前端监控</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/security/1.xss.html" class="nav-link">四、安全防范</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/security/1.xss.html" class="nav-link">五、文件上传下载</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/h5/skill.html" class="nav-link">六、移动端开发</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">阅读书籍</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web-Node/senior/book1/1.preparation.html" class="nav-link">一、Node.js 开发指南</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/vuex.html" class="nav-link">二、了不起的 Node.js</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/vue-router.html" class="nav-link">三、Node.js 实战</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/element/Pagination.html" class="nav-link">四、深入浅出 Node.js</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web-Node/base/stack/1.dataType.html" class="nav-link">一、堆栈内存和闭包作用域</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/oop/1.objectOriented.html" class="nav-link">二、面向对象程序设计</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/3.browser/1.browser.html" class="nav-link">三、浏览器渲染机制</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/dom/1.event.html" class="nav-link">四、DOM事件及设计模式</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/es6/1.let.html" class="nav-link">五、ES6+核心源码分析</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/base/http/1.http.html" class="nav-link">六、AJAX/HTTP数据通信</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">专项知识</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web-Node/senior/performance/1.CDN.html" class="nav-link">一、前端性能优化</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/typeScript/15.api.html" class="nav-link">二、TypeScript</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/monitor/13.jiankong.html" class="nav-link">三、前端监控</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/security/1.xss.html" class="nav-link">四、安全防范</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/security/1.xss.html" class="nav-link">五、文件上传下载</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/h5/skill.html" class="nav-link">六、移动端开发</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">阅读书籍</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Web-Node/senior/book1/1.preparation.html" class="nav-link">一、Node.js 开发指南</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/vuex.html" class="nav-link">二、了不起的 Node.js</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/vue-router.html" class="nav-link">三、Node.js 实战</a></li><li class="dropdown-item"><!----> <a href="/Web-Node/senior/element/Pagination.html" class="nav-link">四、深入浅出 Node.js</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Web-Node/base/stack/1.dataType.html" class="sidebar-link">9 种数据类型区别及相互转换</a></li><li><a href="/Web-Node/base/stack/2.lexicalAnalysis.html" class="sidebar-link">词法解析和变量提升</a></li><li><a href="/Web-Node/base/stack/3.heapStack.html" aria-current="page" class="active sidebar-link">堆栈内存及垃圾回收机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_1-栈" class="sidebar-link">1.栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_1-1-数据结构中的栈" class="sidebar-link">1.1 数据结构中的栈</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_1-2-代码的运行方式" class="sidebar-link">1.2 代码的运行方式</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_1-3-内存区域" class="sidebar-link">1.3 内存区域</a></li></ul></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_2-队列" class="sidebar-link">2.队列</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_3-数据类型" class="sidebar-link">3.数据类型</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_4、执行上下文" class="sidebar-link">4、执行上下文</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_4-1-如何存储" class="sidebar-link">4.1 如何存储</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_4-2-如何复制" class="sidebar-link">4.2 如何复制</a></li></ul></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_5-多个执行上下文栈" class="sidebar-link">5.多个执行上下文栈</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_5-1-执行上下文分类" class="sidebar-link">5.1 执行上下文分类</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_5-2-多个执行上下文" class="sidebar-link">5.2 多个执行上下文</a></li></ul></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_6-执行山下文生命周期" class="sidebar-link">6.执行山下文生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_6-1-生命周期有两个阶段" class="sidebar-link">6.1 生命周期有两个阶段</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_6-2-变量对象" class="sidebar-link">6.2 变量对象</a></li></ul></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_7-作用域" class="sidebar-link">7.作用域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_7-1-作用域" class="sidebar-link">7.1 作用域</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_7-2-作用域链" class="sidebar-link">7.2 作用域链</a></li></ul></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_8-闭包" class="sidebar-link">8.闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_8-1-闭包" class="sidebar-link">8.1 闭包</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_8-2-闭包优化" class="sidebar-link">8.2 闭包优化</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_8-3-arguments" class="sidebar-link">8.3 arguments</a></li></ul></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_9-var-和-let" class="sidebar-link">9.var 和 let</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_9-1-es5-问题" class="sidebar-link">9.1 ES5 问题</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_9-2-let" class="sidebar-link">9.2 let</a></li><li class="sidebar-sub-header"><a href="/Web-Node/base/stack/3.heapStack.html#_9-3-var-let-const" class="sidebar-link">9.3 var let const</a></li></ul></li></ul></li><li><a href="/Web-Node/base/stack/4.bottomLayerOperation.html" class="sidebar-link">JS 底层运行机制：EC/AO/VO/GO</a></li><li><a href="/Web-Node/base/stack/5.scope.html" class="sidebar-link">作用域和作用域链</a></li><li><a href="/Web-Node/base/stack/7.closure.html" class="sidebar-link">闭包及其两大作用：保存/保护</a></li><li><a href="/Web-Node/base/stack/8.highLevelProgramming.html" class="sidebar-link">高阶编程：惰性函数/柯里化函数/compose 组合函数</a></li><li><a href="/Web-Node/base/stack/9.utils.html" class="sidebar-link">BAT/TMD 经典面试题深入剖析</a></li><li><a href="/Web-Node/base/stack/10.ui.html" class="sidebar-link">jQuery 源码解读 [ 基本骨架 ]</a></li><li><a href="/Web-Node/base/stack/11.data.html" class="sidebar-link">Lodash 源码解读 [ 函数防抖和节流等 ]</a></li><li><a href="/Web-Node/base/stack/12.skill.html" class="sidebar-link">Lodash 源码解读 [ 函数防抖和节流等 ]</a></li><li><a href="/Web-Node/base/stack/13.com.html" class="sidebar-link">Lodash 源码解读 [ 函数防抖和节流等 ]</a></li><li><a href="/Web-Node/base/stack/14.data.html" class="sidebar-link">Lodash 源码解读 [ 函数防抖和节流等 ]</a></li><li><a href="/Web-Node/base/stack/15.api.html" class="sidebar-link">Lodash 源码解读 [ 函数防抖和节流等 ]</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="堆栈内存及垃圾回收机制"><a href="#堆栈内存及垃圾回收机制" class="header-anchor">#</a> 堆栈内存及垃圾回收机制</h1> <h2 id="_1-栈"><a href="#_1-栈" class="header-anchor">#</a> 1.栈</h2> <ul><li>栈者，存储货物或供旅客住宿的地方，可引申为仓库</li></ul> <h3 id="_1-1-数据结构中的栈"><a href="#_1-1-数据结构中的栈" class="header-anchor">#</a> 1.1 数据结构中的栈</h3> <ul><li>栈是一组数据的存放方式，特点是先进后出，后进先出</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Stack</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> item<span class="token operator">:</span>number <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token function">push</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token operator">:</span>number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_1-2-代码的运行方式"><a href="#_1-2-代码的运行方式" class="header-anchor">#</a> 1.2 代码的运行方式</h3> <ul><li>表示函数的一层层调用</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">debugger</span>
    <span class="token punctuation">}</span>
    <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_1-3-内存区域"><a href="#_1-3-内存区域" class="header-anchor">#</a> 1.3 内存区域</h3> <ul><li>栈也是存放数据的一种内存区域</li> <li>程序运行的时候，需要内存空间存放数据。一般来说，系统会划分出两种不同的内存空间：一种叫做 stack，另一种叫做 heap
<ul><li>stack 是有结构的，每个区块按照一定的次序存放，可以明确知道每个区块的大小</li> <li>heap 是没有结构的，数据可以任意的存放。因此，stack 的寻址速度要快于 heap</li></ul></li> <li>只要是局部的、占用空间确定的数据，一般都存放在 stack 里面，否则就放在 heap 里面，所有的对象都存放在 heap</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_2-队列"><a href="#_2-队列" class="header-anchor">#</a> 2.队列</h2> <ul><li>队列是一种操作受限制的线性表</li> <li>特殊之处在于它只允许在表的前端进行删除操作，而在表的后端进行插入操作</li> <li>进行插入操作的称为队尾，进行删除操作的端称为队头</li> <li>因为队列只允许在一端插入，在另一端删除，所以只有最早进入队列的元素才能最先从队列中删除，故队列又称为先进先出线性表</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Queue</span><span class="token punctuation">{</span>
  <span class="token keyword">private</span> items<span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token operator">:</span>number</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>item<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>emement<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">dequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
queue<span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
queue<span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
queue<span class="token punctuation">.</span><span class="token function">enqueue</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>queue<span class="token punctuation">.</span><span class="token function">dequeue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_3-数据类型"><a href="#_3-数据类型" class="header-anchor">#</a> 3.数据类型</h2> <ul><li>JS 中有七种数据类型
<ul><li>基本数据类型： number、string、boolean、undefined、null、symbol</li> <li>引用数据类型： object、function</li></ul></li></ul> <h2 id="_4、执行上下文"><a href="#_4、执行上下文" class="header-anchor">#</a> 4、执行上下文</h2> <h3 id="_4-1-如何存储"><a href="#_4-1-如何存储" class="header-anchor">#</a> 4.1 如何存储</h3> <ul><li>当函数运行时，会创建一个执行环境，这个执行环境就叫做执行上下文</li> <li>执行上下文中会创建一个对象叫做变量对象（Value Object），基础数据类型都保存在变量对象中</li> <li>引用数据类型的值保存在堆里，我们通过操作对象的引用地址来操作对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;zhufeng&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> ExecuteContent <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token string">&quot;XO1&quot;</span><span class="token punctuation">,</span>
    c<span class="token operator">:</span> <span class="token string">&quot;XA1&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_4-2-如何复制"><a href="#_4-2-如何复制" class="header-anchor">#</a> 4.2 如何复制</h3> <h4 id="_4-2-1-基本数据"><a href="#_4-2-1-基本数据" class="header-anchor">#</a> 4.2.1 基本数据</h4> <ul><li>基本数据类型复制的是值本身</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a
b <span class="token operator">=</span> <span class="token number">2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> ExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>b <span class="token operator">=</span> ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a
ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_4-2-2-引用数据"><a href="#_4-2-2-引用数据" class="header-anchor">#</a> 4.2.2 引用数据</h4> <ul><li>引用数据类型复制的是引用地址指针</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> n <span class="token operator">=</span> m
n<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>b<span class="token operator">=</span> ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a
ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a<span class="token operator">=</span><span class="token number">10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_5-多个执行上下文栈"><a href="#_5-多个执行上下文栈" class="header-anchor">#</a> 5.多个执行上下文栈</h2> <h3 id="_5-1-执行上下文分类"><a href="#_5-1-执行上下文分类" class="header-anchor">#</a> 5.1 执行上下文分类</h3> <ul><li>JS 代码在执行的时候会进入一个执行上下文，可以理解为当前代码的运行环境</li> <li>在 JS 中运行环境主要分为全局执行上下文环境和函数执行上下文环境
<ul><li>全局执行上下文中只有一个，在客户端中一般由浏览器创建，也就是我们熟知的 window 对象，我们能通过 this 直接访问到它</li> <li>window 对象还是 var 声明的全局变量的载体。我们通过 var 创建的全局对象，都可以通过 window 直接访问</li></ul></li></ul> <h3 id="_5-2-多个执行上下文"><a href="#_5-2-多个执行上下文" class="header-anchor">#</a> 5.2 多个执行上下文</h3> <ul><li>在 JS 执行过程会产生多个执行上下文，JS 引擎会有栈来管理这些执行上下文</li> <li>执行上下文栈也叫做调用栈，执行栈用于存储代码执行期间创建的所有上下文，具有 LIFO（先进后出）的特性</li> <li>栈底永远是全局上下文，栈顶为当前正在执行的上下文</li> <li>当开启一个函数执行时会生成一个新的执行上下文并放入调用栈，执行完毕后自动出栈。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">debugger</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">debugger</span>
    <span class="token keyword">function</span> <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">debugger</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">debugger</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> globalExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    setTimeout<span class="token operator">:</span> <span class="token string">&quot;setTimeout&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span>globalExecuteContext<span class="token punctuation">]</span>
<span class="token keyword">var</span> oneExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
executeContextStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>oneExecuteContext<span class="token punctuation">)</span>
<span class="token keyword">var</span> towExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span> b<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
executeContextStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>twoExecuteContext<span class="token punctuation">)</span>
<span class="token keyword">var</span> threeExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span> c<span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
executeContextStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>threeExecuteContext<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>executeContextStack<span class="token punctuation">)</span>
executeContextStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
executeContextStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
executeContextStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_6-执行山下文生命周期"><a href="#_6-执行山下文生命周期" class="header-anchor">#</a> 6.执行山下文生命周期</h2> <h3 id="_6-1-生命周期有两个阶段"><a href="#_6-1-生命周期有两个阶段" class="header-anchor">#</a> 6.1 生命周期有两个阶段</h3> <ul><li>一个新的执行上下文的生命周期有两个阶段
<ul><li>创建阶段
<ul><li>创建变量对象</li> <li>确定作用域链</li> <li>确定<code>this</code>指向</li></ul></li> <li>执行阶段
<ul><li>变量赋值</li> <li>函数赋值</li> <li>代码执行</li></ul></li></ul></li></ul> <h3 id="_6-2-变量对象"><a href="#_6-2-变量对象" class="header-anchor">#</a> 6.2 变量对象</h3> <ul><li>变量对象会保存变量声明（var）、函数参数（arguments）、函数定义（function）
<ul><li>变量对象会首先获得函数的参数变量和值</li> <li>获取所用<code>function</code>进行函数声明，函数名为变量对象的属性名，值为函数对象，如果属性已经存在，值会用新值覆盖</li> <li>再依次所有的 var 关键字进行的变量声明，每找到一个变量声明，就会在变量对象上建一个属性，值为<code>undefined</code>,如果变量名已经存在，则会跳过，并不会修改原属性值，<code>let</code>声明的变量并不会在此阶段进行处理</li> <li>函数声明优先级更高，同名的函数会覆盖函数和变量，但同名<code>var</code>变量并不会覆盖函数，执行阶段重新赋值可以改变原有的值</li></ul></li></ul> <h4 id="_6-2-1-基本类型"><a href="#_6-2-1-基本类型" class="header-anchor">#</a> 6.2.1 基本类型</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>var a = undefined//变量提升 console.log(a);a=1</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;new_fn&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn_a&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token string">&quot;var_fn&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>真正执行</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建阶段</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;new_fn&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn_a&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">undefined</span>
<span class="token keyword">var</span> fn <span class="token operator">=</span> <span class="token keyword">undefined</span>
<span class="token comment">// 执行阶段</span>
a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
fn <span class="token operator">=</span> <span class="token string">&quot;var_fn&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>上下文</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 创建阶段</span>
<span class="token keyword">var</span> globalEC <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>arguments<span class="token punctuation">,</span>
    <span class="token function-variable function">a</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn_a&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;new_fn&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>globalEC<span class="token punctuation">]</span>
<span class="token comment">// 执行阶段</span>
globalEC<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>globalEC<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span>
globalEC<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
globalEC<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token string">&quot;var_fn&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>globalEC<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">.</span>fn<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_6-2-3-激活对象"><a href="#_6-2-3-激活对象" class="header-anchor">#</a> 6.2.3 激活对象</h4> <ul><li>在函数的调用栈中，如果当前执行上下文处于函数调用栈的顶端，则意味着当前上下文处于激活状态，此时变量对象称为活动对象（AO）</li> <li>活动变量包含变量对象所有的属性，并有包含<code>this</code>指针</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// 执行阶段 VO=&gt;AO</span>
<span class="token keyword">let</span> <span class="token constant">VO</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">AO</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  m<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token function-variable function">two</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> oneEC <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token punctuation">,</span>
  <span class="token keyword">this</span><span class="token operator">:</span> window<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token constant">VO</span><span class="token punctuation">,</span> globalVO<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="_6-2-4-全局上下文的变量对象"><a href="#_6-2-4-全局上下文的变量对象" class="header-anchor">#</a> 6.2.4 全局上下文的变量对象</h4> <ul><li>在浏览器里，全局对象为<code>window</code></li> <li>全局上下文的变量对象为<code>window</code>,而且这个变量对象不能激活变成活动对象</li> <li>只在窗口打开，全局上下文会一直存在，所有的上下文都可以直接访问全局上下文变量对象上的属性</li> <li>只有全局上下文的变量对象允许通过 VO 的属性名称来间接访问，在函数上下文中是不能直接访问 VO 对象的</li> <li>未进入执行阶段前，变量对象中的属性都不能访问！但是进入到执行阶段后，变量对象抓变成了活动对象，里面的属性都能被访问了，对于函数上下文来讲，活动对象与变量对象其实都是同一个对象，知识处于执行上下文的不同生命周期</li></ul> <h2 id="_7-作用域"><a href="#_7-作用域" class="header-anchor">#</a> 7.作用域</h2> <h3 id="_7-1-作用域"><a href="#_7-1-作用域" class="header-anchor">#</a> 7.1 作用域</h3> <ul><li>在 JS 中，作用域是用来规定变量访问范围的规则</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_7-2-作用域链"><a href="#_7-2-作用域链" class="header-anchor">#</a> 7.2 作用域链</h3> <ul><li>作用域链是由当前执行环境与上一层执行环境的一系列变量对象组成的，它保证了当前执行环境对符合访问权限的变量和函数的有序访问。</li></ul> <h4 id="_7-2-1-作用域链"><a href="#_7-2-1-作用域链" class="header-anchor">#</a> 7.2.1 作用域链</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">function</span> <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1.创建全局上下文</span>
<span class="token keyword">var</span> globalExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span> one<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">()=&gt;{var a = 1;}</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> globalExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> globalExecuteContextVO<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>globalExecuteContextVO<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> executeContextStack <span class="token operator">=</span> <span class="token punctuation">[</span>globalExecuteContext<span class="token punctuation">]</span>
<span class="token comment">//2.执行one，创建one执行上下文</span>
<span class="token keyword">var</span> oneExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  two<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">()=&gt;{var b = 2 ;}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> oneExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> oneExecuteContextVO<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>oneExecuteContextVO<span class="token punctuation">,</span> globalExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">//2.执行two，创建two执行上下文</span>
<span class="token keyword">var</span> twoExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span>
  b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  three<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">()=&gt;{var c = 3 ;}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> twoExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> twoExecuteContextVO<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>
    twoExecuteContextVO<span class="token punctuation">,</span>
    oneExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">,</span>
    globalExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">//3.执行three，创建three执行上下文</span>
<span class="token keyword">var</span> threeExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span>
  c<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> threeExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> threeExecuteContextVO<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>
    threeExecuteContextVO<span class="token punctuation">,</span>
    twoExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">,</span>
    oneExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">,</span>
    globalExecuteContext<span class="token punctuation">.</span><span class="token constant">VO</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token parameter">varName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> threeExecuteContext<span class="token punctuation">.</span>scopeChain<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>varName <span class="token keyword">in</span> threeExecuteContext<span class="token punctuation">.</span>scopeChain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> threeExecuteContext<span class="token punctuation">.</span>scopeChain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>varName<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//console.log(a, b, c);</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><h4 id="_7-2-2-作用域链"><a href="#_7-2-2-作用域链" class="header-anchor">#</a> 7.2.2 作用域链</h4> <ul><li><code>scopeChain</code>其实是在创建函数的时候确定的</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> two
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">var</span> two <span class="token operator">=</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1.创建全局上下文</span>
<span class="token keyword">var</span> globalExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span>
  one<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">()=&gt;{var a = 1;}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  a<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  two<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> globalExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> globalExecuteContextVO<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>globalExecuteContextVO<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">//2.开始执行</span>
globalExecuteContextVO<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span>
<span class="token comment">//3.开始执行one</span>
<span class="token keyword">var</span> oneExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> two<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">()=&gt;{console.log(a)}</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> oneExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> oneExecuteContextVO<span class="token punctuation">,</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>oneExecuteContextVO<span class="token punctuation">,</span> globalExecuteContextVO<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
oneExecuteContextVO<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">//4.给two赋值</span>
globalExecuteContextVO<span class="token punctuation">.</span>two <span class="token operator">=</span> oneExecuteContextVO<span class="token punctuation">.</span>two
<span class="token comment">//5.执行two</span>
<span class="token keyword">var</span> twoExecuteContextVO <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> twoExecuteContext <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VO</span><span class="token operator">:</span> twoExecuteContextVO<span class="token punctuation">,</span>
  <span class="token comment">//scopeChain是在创建此函数据的时候就决定了,跟在哪里执行无关</span>
  scopeChain<span class="token operator">:</span> <span class="token punctuation">[</span>
    twoExecuteContextVO<span class="token punctuation">,</span>
    oneExecuteContextVO<span class="token punctuation">,</span>
    globalExecuteContextVO<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="_8-闭包"><a href="#_8-闭包" class="header-anchor">#</a> 8.闭包</h2> <ul><li>闭包有两部分组成，一个是当前的执行上下文 A,一个是在该执行上下文中创建的函数 B</li> <li>当 B 执行的时候引用了当前执行上下文 A 中的变量就会产生闭包</li> <li>当一个值失去引用的时候就会标记，被垃圾回收机制回收并释放空间</li> <li>闭包的本质就是在函数外部保持内部变量的引用，从而阻止垃圾回收</li> <li>调用栈并不会影响作用域链，函数调用栈是在执行时才确定，而作用域规则是在代码编译阶段就已经确定了</li> <li>MDN 定义：闭包是指这样的作用域<code>foo</code>，它包含了一个函数<code>fn</code>,这个函数<code>fn</code>可以调用被这个作用域所封闭的变量<code>a</code>，函数等内容</li></ul> <h3 id="_8-1-闭包"><a href="#_8-1-闭包" class="header-anchor">#</a> 8.1 闭包</h3> <ul><li><code>Call Stack</code>为当前的函数调用栈</li> <li><code>Scope</code>为当前正在被执行函数的作用域链</li> <li><code>Local</code>为当前的活动对象</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span>
    <span class="token keyword">debugger</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> two
<span class="token punctuation">}</span>
<span class="token keyword">let</span> two <span class="token operator">=</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">debugger</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_8-2-闭包优化"><a href="#_8-2-闭包优化" class="header-anchor">#</a> 8.2 闭包优化</h3> <ul><li>中间没用到的变量闭包会被忽略</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">function</span> <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span>
      <span class="token keyword">debugger</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token keyword">function</span> <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">function</span> <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token number">3</span>
      <span class="token keyword">debugger</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">three</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">two</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_8-3-arguments"><a href="#_8-3-arguments" class="header-anchor">#</a> 8.3 arguments</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">debugger</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_9-var-和-let"><a href="#_9-var-和-let" class="header-anchor">#</a> 9.var 和 let</h2> <ul><li>JS 中作用域有：全局作用域、函数作用域。没有块级作用域的概念。ES6 中新增了块级作用域。</li> <li>块级作用域由<code>{}</code>包括，<code>if</code>语句和<code>for</code>语句里面的<code>{}</code>也属于块作用域。</li></ul> <h3 id="_9-1-es5-问题"><a href="#_9-1-es5-问题" class="header-anchor">#</a> 9.1 ES5 问题</h3> <h4 id="_9-1-1-全局变量"><a href="#_9-1-1-全局变量" class="header-anchor">#</a> 9.1.1 全局变量</h4> <ul><li>在 if 或者 for 循环中声明的变量会变成全局变量</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">//5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_9-1-2-内层变量可能会覆盖外层变量"><a href="#_9-1-2-内层变量可能会覆盖外层变量" class="header-anchor">#</a> 9.1.2 内层变量可能会覆盖外层变量</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_9-2-let"><a href="#_9-2-let" class="header-anchor">#</a> 9.2 let</h3> <ul><li>允许块级作用域任意嵌套</li> <li>外层作用域无法读取内层作用域的变量</li> <li>内层作用域可以定义外层作用域的同名变量</li> <li>函数本身的作用域在其所在的块级作用域之内</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;use strict&quot;</span>
<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;out&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;in&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_9-3-var-let-const"><a href="#_9-3-var-let-const" class="header-anchor">#</a> 9.3 var let const</h3> <ul><li>var 定义的变量没有块的概念，可以跨块访问，不能跨函数访问，有变量提升，可重复声明</li> <li>let 定义的变量，只能在块作用域里访问，不能跨块访问，也不能跨函数访问，无变量提升，不可以重复声明</li> <li>let 声明的变量只在块级作用域内有效，不存在变量提升，不可以重复声明</li> <li>或者说 let 变量提升了，但是在 let 声明变量前不能使用该变量，这特性叫暂时性死区</li> <li>如果有重复变量<code>let</code>会在编译阶段报错</li></ul> <h4 id="_9-3-1-暂时性死区"><a href="#_9-3-1-暂时性死区" class="header-anchor">#</a> 9.3.1 暂时性死区</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 不存在变量提升</span>
<span class="token string">&quot;use strict&quot;</span>
<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token keyword">let</span> i
<span class="token punctuation">}</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 报错</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_9-3-2-全局变量"><a href="#_9-3-2-全局变量" class="header-anchor">#</a> 9.3.2 全局变量</h4> <ul><li>ES5 声明变量只有两种方式：var 和 function</li> <li>ES6 有 let、const、import、class、var、function 共六种声明变量的方式</li> <li>浏览器环境中顶层对象时 window，Node 中是 global 对象</li> <li>ES5 中顶层对象的属性等价于全局变量</li> <li>ES6 中 var、function 声明的全局变量，依然是顶层对象的属性；let、const、class 声明的全局变量不属于顶层对象的属性</li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2021/5/16 下午9:35:54</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Web-Node/base/stack/2.lexicalAnalysis.html" class="prev">
          词法解析和变量提升
        </a></span> <span class="next"><a href="/Web-Node/base/stack/4.bottomLayerOperation.html">
          JS 底层运行机制：EC/AO/VO/GO
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/Web-Node/assets/js/app.3f8e6221.js" defer></script><script src="/Web-Node/assets/js/41.8b6b5854.js" defer></script>
  </body>
</html>
